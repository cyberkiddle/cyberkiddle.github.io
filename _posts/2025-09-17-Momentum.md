---
layout: post
title: Momentum 1
date: 17-09-2025
categories: [Basics]
tags: [exfiltration, blind, commandinjection, wget]
image: "https://study.com/cimages/multimages/16/newtons-cradle-256213_6402448514290682214798.jpg"
---

## Scanning
```
# Nmap 7.95 scan initiated Wed Sep 17 19:57:15 2025 as: /usr/lib/nmap/nmap --privileged -sC -sV -p- -oN scan.txt 192.168.56.104
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers
Nmap scan report for 192.168.56.104
Host is up (0.000073s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey: 
|   2048 5c:8e:2c:cc:c1:b0:3e:7c:0e:22:34:d8:60:31:4e:62 (RSA)
|   256 81:fd:c6:4c:5a:50:0a:27:ea:83:38:64:b9:8b:bd:c1 (ECDSA)
|_  256 c1:8f:87:c1:52:09:27:60:5f:2e:2d:e0:08:03:72:c8 (ED25519)
80/tcp open  http    Apache httpd 2.4.38 ((Debian))
|_http-server-header: Apache/2.4.38 (Debian)
|_http-title: Momentum | Index 
MAC Address: 08:00:27:83:D7:AD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Wed Sep 17 19:57:23 2025 -- 1 IP address (1 host up) scanned in 8.01 seconds
```

## Enumerating

http://192.168.56.104/js/ >>> Here i found the js script that calls the same name i write in id section.

```
function viewDetails(str) {

  window.location.href = "opus-details.php?id="+str;
}

/*
var CryptoJS = require("crypto-js");
var decrypted = CryptoJS.AES.decrypt(encrypted, "SecretPassphraseMomentum");
console.log(decrypted.toString(CryptoJS.enc.Utf8));
*/

```


In the browser we can see if we select any image we get the hardcorded structure.
we can try to use the web browser to decode thye hard coded hash.

```
// Load CryptoJS first
var script = document.createElement('script');
script.src = "https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js";
script.onload = function() {
    // Once loaded, decrypt
    var encrypted = "U2FsdGVkX193yTOKOucUbHeDp1Wxd5r7YkoM8daRtj0rjABqGuQ6Mx28N1VbBSZt";
    var bytes  = CryptoJS.AES.decrypt(encrypted, "SecretPassphraseMomentum");
    var plaintext = bytes.toString(CryptoJS.enc.Utf8);
    console.log("Decrypted:", plaintext);
};
document.head.appendChild(script);




// Load CryptoJS first var script = document.createElement('script'); script.src = "https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"; script.onload = function() { // Once loaded, decrypt… <script src="https://cdnjs.cloudflare…s/4.1.1/crypto-js.min.js"> Decrypted: auxerre-alienum##



```
<img width="1249" height="255" alt="Screenshot From 2025-09-17 20-20-56" src="https://github.com/user-attachments/assets/fcfc4be2-dadb-4307-9bf5-8f8a0fbea36e" />


## Try to see if we can use this to authenticate
```
auxerre-alienum## >>> But really what will the name the possible username will be auxerre : auxerre-alienum##
			Or auxerre and alienum##

i Googled if is a name

>>> Yes, "Auxerre" can refer to the capital city of the Yonne department in France, a place with a rich history dating back to Roman times, and
it can also be used as a surname or even a given name, sometimes linked to its association with the French city. The word itself originates from the Latin for the ancient city of Auxerre. 




~/Desktop/redteam/momentum » ssh auxerre@192.168.56.104                                            130 ↵ cyberkid@kali
The authenticity of host '192.168.56.104 (192.168.56.104)' can't be established.
ED25519 key fingerprint is SHA256:NLUFYImFHvyED76cAzjnxD3dTxP5rzmEHrx4acGvM9c.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.56.104' (ED25519) to the list of known hosts.
auxerre@192.168.56.104's password: 
Permission denied, please try again.
auxerre@192.168.56.104's password: 
Linux Momentum 4.19.0-16-amd64 #1 SMP Debian 4.19.181-1 (2021-03-19) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Thu Apr 22 08:47:31 2021
auxerre@Momentum:~$ cat user.txt 
[ Momentum - User Owned ]
---------------------------------------
flag : 84157165c30ad34d18945b647ec7f647
---------------------------------------
auxerre@Momentum:~$ 



```

## Privilege escalation
```

auxerre@Momentum:/etc$ ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root         1  0.0  0.4 103864  9952 ?        Ss   12:38   0:00 /sbin/init
root         2  0.0  0.0      0     0 ?        S    12:38   0:00 [kthreadd]
root         3  0.0  0.0      0     0 ?        I<   12:38   0:00 [rcu_gp]
root         4  0.0  0.0      0     0 ?        I<   12:38   0:00 [rcu_par_gp]
root         6  0.0  0.0      0     0 ?        I<   12:38   0:00 [kworker/0:0H-k
root         8  0.0  0.0      0     0 ?        I<   12:38   0:00 [mm_percpu_wq]
root         9  0.1  0.0      0     0 ?        S    12:38   0:05 [ksoftirqd/0]
root        10  0.0  0.0      0     0 ?        I    12:38   0:01 [rcu_sched]
root        11  0.0  0.0      0     0 ?        I    12:38   0:00 [rcu_bh]
root        12  0.0  0.0      0     0 ?        S    12:38   0:00 [migration/0]
root        14  0.0  0.0      0     0 ?        S    12:38   0:00 [cpuhp/0]
root        15  0.0  0.0      0     0 ?        S    12:38   0:00 [kdevtmpfs]
root        16  0.0  0.0      0     0 ?        I<   12:38   0:00 [netns]
root        17  0.0  0.0      0     0 ?        S    12:38   0:00 [kauditd]
root        18  0.0  0.0      0     0 ?        S    12:38   0:00 [khungtaskd]
root        19  0.0  0.0      0     0 ?        S    12:38   0:00 [oom_reaper]
root        20  0.0  0.0      0     0 ?        I<   12:38   0:00 [writeback]
root        21  0.0  0.0      0     0 ?        S    12:38   0:00 [kcompactd0]
root        22  0.0  0.0      0     0 ?        SN   12:38   0:00 [ksmd]
root        23  0.0  0.0      0     0 ?        SN   12:38   0:00 [khugepaged]
root        24  0.0  0.0      0     0 ?        I<   12:38   0:00 [crypto]
root        25  0.0  0.0      0     0 ?        I<   12:38   0:00 [kintegrityd]
root        26  0.0  0.0      0     0 ?        I<   12:38   0:00 [kblockd]
root        27  0.0  0.0      0     0 ?        I<   12:38   0:00 [edac-poller]
root        28  0.0  0.0      0     0 ?        I<   12:38   0:00 [devfreq_wq]
root        29  0.0  0.0      0     0 ?        S    12:38   0:00 [watchdogd]
root        30  0.0  0.0      0     0 ?        S    12:38   0:00 [kswapd0]
root        48  0.0  0.0      0     0 ?        I<   12:38   0:00 [kthrotld]
root        49  0.0  0.0      0     0 ?        I<   12:38   0:00 [ipv6_addrconf]
root        59  0.0  0.0      0     0 ?        I<   12:38   0:00 [kstrp]
root       100  0.0  0.0      0     0 ?        I<   12:38   0:00 [ata_sff]
root       113  0.0  0.0      0     0 ?        S    12:38   0:00 [scsi_eh_0]
root       115  0.0  0.0      0     0 ?        S    12:38   0:00 [scsi_eh_1]
root       116  0.0  0.0      0     0 ?        I<   12:38   0:00 [scsi_tmf_0]
root       117  0.0  0.0      0     0 ?        I<   12:38   0:00 [scsi_tmf_1]
root       119  0.0  0.0      0     0 ?        S    12:38   0:00 [scsi_eh_2]
root       121  0.0  0.0      0     0 ?        I<   12:38   0:00 [scsi_tmf_2]
root       123  0.0  0.0      0     0 ?        I    12:38   0:00 [kworker/u2:2-e
root       158  0.0  0.0      0     0 ?        I<   12:38   0:00 [kworker/0:1H-k
root       189  0.0  0.0      0     0 ?        I<   12:38   0:00 [kworker/u3:0]
root       191  0.0  0.0      0     0 ?        S    12:38   0:00 [jbd2/sda1-8]
root       192  0.0  0.0      0     0 ?        I<   12:38   0:00 [ext4-rsv-conve
root       221  0.0  0.3  24016  7804 ?        Ss   12:38   0:00 /lib/systemd/sy
root       244  0.0  0.2  22464  5412 ?        Ss   12:38   0:00 /lib/systemd/sy
systemd+   250  0.0  0.3  93084  6448 ?        Ssl  12:38   0:00 /lib/systemd/sy
root       321  0.0  0.0      0     0 ?        I<   12:38   0:00 [ttm_swap]
root       322  0.0  0.0      0     0 ?        S    12:38   0:00 [irq/18-vmwgfx]
root       358  0.0  0.2   9488  5616 ?        Ss   12:38   0:00 /sbin/dhclient 
root       366  0.0  0.1   8504  2688 ?        Ss   12:38   0:00 /usr/sbin/cron 
root       367  0.0  0.1 225824  3792 ?        Ssl  12:38   0:00 /usr/sbin/rsysl
root       368  0.0  0.3  19392  7168 ?        Ss   12:38   0:00 /lib/systemd/sy
message+   369  0.0  0.2   8972  4300 ?        Ss   12:38   0:00 /usr/bin/dbus-d
root       385  0.0  0.2  19768  5176 ?        Ss   12:38   0:00 /sbin/wpa_suppl
root       429  0.0  0.0   5612  1488 tty1     Ss+  12:38   0:00 /sbin/agetty -o
redis      456  0.1  0.4  51672  9656 ?        Ssl  12:38   0:04 /usr/bin/redis-
root       473  0.0  0.3  15852  7128 ?        Ss   12:38   0:00 /usr/sbin/sshd 
root       530  0.0  0.6  57512 13172 ?        Ss   12:38   0:00 /usr/sbin/apach
www-data   692  0.3  0.6  57988 12376 ?        S    12:41   0:11 /usr/sbin/apach
www-data   695  0.3  0.6  58060 12460 ?        S    12:42   0:09 /usr/sbin/apach
www-data   696  0.2  0.6  58052 12448 ?        S    12:42   0:09 /usr/sbin/apach
www-data   784  0.3  0.6  58060 12524 ?        S    12:49   0:08 /usr/sbin/apach
www-data   785  0.3  0.6  58052 12448 ?        S    12:49   0:08 /usr/sbin/apach
www-data   792  0.2  0.6  58060 12480 ?        S    12:50   0:06 /usr/sbin/apach
www-data   827  0.0  0.6  58052 12368 ?        S    12:58   0:01 /usr/sbin/apach
www-data   829  0.0  0.6  58052 12368 ?        S    12:58   0:01 /usr/sbin/apach
www-data   831  0.0  0.6  58052 12436 ?        S    12:58   0:01 /usr/sbin/apach
www-data   832  0.0  0.6  58060 12452 ?        S    12:58   0:01 /usr/sbin/apach
root       839  0.0  0.0      0     0 ?        I    13:04   0:01 [kworker/0:0-ev
root       921  0.0  0.4  17016  8384 ?        Ss   13:22   0:00 sshd: auxerre [
auxerre    929  0.0  0.4  21028  8220 ?        Ss   13:22   0:00 /lib/systemd/sy
auxerre    930  0.0  0.1 105112  2352 ?        S    13:22   0:00 (sd-pam)
auxerre    938  0.0  0.2  17016  5064 ?        S    13:22   0:00 sshd: auxerre@p
auxerre    939  0.0  0.2   8240  4900 pts/0    Ss   13:22   0:00 -bash
root       996  0.0  0.0      0     0 ?        I    13:29   0:00 [kworker/u2:0-e
root      1004  0.0  0.0      0     0 ?        I    13:30   0:00 [kworker/0:2-at
auxerre   1045  0.0  0.4  16876  8544 pts/0    S+   13:35   0:00 python3 -c impo
auxerre   1046  0.0  0.2   7676  4372 pts/1    Ss   13:35   0:00 /bin/bash
root      1051  0.0  0.0      0     0 ?        I    13:35   0:00 [kworker/0:1-at
auxerre   1052  0.0  0.1  10632  3116 pts/1    R+   13:36   0:00 ps aux
auxerre@Momentum:/etc$ redis-cli
127.0.0.1:6379> KEY*
(error) ERR unknown command `KEY*`, with args beginning with: 
127.0.0.1:6379> info
# Server
redis_version:5.0.3
redis_git_sha1:00000000
redis_git_dirty:0
redis_build_id:94145a25ce04923
redis_mode:standalone
os:Linux 4.19.0-16-amd64 x86_64
arch_bits:64
multiplexing_api:epoll
atomicvar_api:atomic-builtin
gcc_version:8.3.0
process_id:456
run_id:fd5bb632970acbd746093ef6f3f4e4d41cf3119f
tcp_port:6379
uptime_in_seconds:3459
uptime_in_days:0
hz:10
configured_hz:10
lru_clock:13300115
executable:/usr/bin/redis-server
config_file:/etc/redis/redis.conf

# Clients
connected_clients:1
client_recent_max_input_buffer:2
client_recent_max_output_buffer:0
blocked_clients:0

# Memory
used_memory:858816
used_memory_human:838.69K
used_memory_rss:12685312
used_memory_rss_human:12.10M
used_memory_peak:858816
used_memory_peak_human:838.69K
used_memory_peak_perc:100.00%
used_memory_overhead:846558
used_memory_startup:796760
used_memory_dataset:12258
used_memory_dataset_perc:19.75%
allocator_allocated:1520096
allocator_active:1880064
allocator_resident:8695808
total_system_memory:2092285952
total_system_memory_human:1.95G
used_memory_lua:41984
used_memory_lua_human:41.00K
used_memory_scripts:0
used_memory_scripts_human:0B
number_of_cached_scripts:0
maxmemory:0
maxmemory_human:0B
maxmemory_policy:noeviction
allocator_frag_ratio:1.24
allocator_frag_bytes:359968
allocator_rss_ratio:4.63
allocator_rss_bytes:6815744
rss_overhead_ratio:1.46
rss_overhead_bytes:3989504
mem_fragmentation_ratio:15.51
mem_fragmentation_bytes:11867480
mem_not_counted_for_evict:0
mem_replication_backlog:0
mem_clients_slaves:0
mem_clients_normal:49694
mem_aof_buffer:0
mem_allocator:jemalloc-5.1.0
active_defrag_running:0
lazyfree_pending_objects:0

# Persistence
loading:0
rdb_changes_since_last_save:0
rdb_bgsave_in_progress:0
rdb_last_save_time:1758127120
rdb_last_bgsave_status:ok
rdb_last_bgsave_time_sec:-1
rdb_current_bgsave_time_sec:-1
rdb_last_cow_size:0
aof_enabled:0
aof_rewrite_in_progress:0
aof_rewrite_scheduled:0
aof_last_rewrite_time_sec:-1
aof_current_rewrite_time_sec:-1
aof_last_bgrewrite_status:ok
aof_last_write_status:ok
aof_last_cow_size:0

# Stats
total_connections_received:1
total_commands_processed:1
instantaneous_ops_per_sec:0
total_net_input_bytes:45
total_net_output_bytes:11525
instantaneous_input_kbps:0.00
instantaneous_output_kbps:0.00
rejected_connections:0
sync_full:0
sync_partial_ok:0
sync_partial_err:0
expired_keys:0
expired_stale_perc:0.00
expired_time_cap_reached_count:0
evicted_keys:0
keyspace_hits:0
keyspace_misses:0
pubsub_channels:0
pubsub_patterns:0
latest_fork_usec:0
migrate_cached_sockets:0
slave_expires_tracked_keys:0
active_defrag_hits:0
active_defrag_misses:0
active_defrag_key_hits:0
active_defrag_key_misses:0

# Replication
role:master
connected_slaves:0
master_replid:38a1b1ccd86149e092cb065e47f434cc4106c35a
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:0
second_repl_offset:-1
repl_backlog_active:0
repl_backlog_size:1048576
repl_backlog_first_byte_offset:0
repl_backlog_histlen:0

# CPU
used_cpu_sys:2.843560
used_cpu_user:1.459195
used_cpu_sys_children:0.000000
used_cpu_user_children:0.000000

# Cluster
cluster_enabled:0

# Keyspace
db0:keys=1,expires=0,avg_ttl=0
127.0.0.1:6379> 127.0.0.1:6379> KEYS *
(error) ERR unknown command `127.0.0.1:6379>`, with args beginning with: `KEYS`, `*`, 
127.0.0.1:6379> KEYS *
1) "rootpass"
127.0.0.1:6379> TYPE rootpass
string
127.0.0.1:6379> GET rootpass
"m0mentum-al1enum##"
127.0.0.1:6379> 
127.0.0.1:6379> exit
auxerre@Momentum:/etc$ su root
Password: 
root@Momentum:/etc# cd /root
root@Momentum:~# cat root.txt 
[ Momentum - Rooted ]
---------------------------------------
Flag : 658ff660fdac0b079ea78238e5996e40
---------------------------------------
by alienum with <3

root@Momentum:~# 


```

<img width="1920" height="1080" alt="Screenshot From 2025-09-17 20-44-58" src="https://github.com/user-attachments/assets/71258cc7-5911-47d7-aad9-66611be67723" />


